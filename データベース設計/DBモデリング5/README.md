## データベースモデリング5

![My Image](./dbmodelling5_1.png)

## 課題1

### 各テーブルの目的
- Authors
  - author_idを保有してユーザーを管理するテーブル
  - 個人情報はPersonal_Informationで管理
- Personal_Information(必須要件ではない)
  - 今回の課題的には必要がないテーブル
  - ただ、実務を考えると個人情報は別テーブルに分けて保管する
  - Authorsとは１対１の関係性を持っている 
- Articles
  - 最新状態の記事を持つテーブル
  - このテーブルには、最新状態のタイトル、記事の内容が保存されている
- Article_Changes
  - 記事の変更履歴を持つテーブル
  - 基本的にはタイトルと記事の内容が保存されている
- Tags(必須要件ではない)
  - 記事に付与するTagを管理するテーブル
- Article_Tag
  - article_idとtag_id複合主キーを作成して紐付ける
  - なぜ変更履歴(Article_Changes)と紐付けないのか
    - 変更履歴はあくまでコンテンツ自体の変更を管理する
    - タグはコンテンツが所属するカテゴリや属性の情報を付与するためにあり、これらは変更があまりないと推測

### 各要件に対して対応方法

- 記事
  - 1000文字程度の本文を記入して保存できる
    - latest_contentsはtext型を持たせた
    - 使用するDBMSに依存するが、65,535バイト分の情報を保持できる
- 記事の履歴
  - 記事を更新すると履歴が保存される
    - 記事を更新するとArticle_Changesに新たなレコードをInsertする
  - 特定の記事の履歴を一覧表示できる
    - Article_Changesからarticle_idを条件に抽出可能
  - 履歴を選択して過去の記事状態に戻す事が可能
    - Article_Changesから戻したい過去の記事を抽出してArticlesのlatest_titleとlatest_contentsを書き換える
    - 書き換えた後に戻した記事以降に書かれた記事を物理削除する
      - 論理削除して一定期間保存後物理削除するアプローチもできると思う
- 記事の閲覧
  - 最新状態の記事を一覧表示できる
    - Articlesを使えば一覧表示できる

