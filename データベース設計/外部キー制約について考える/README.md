## 外部キー制約について考える

### 課題1

```
親子関係にあるデータに外部キー制約を一切定義しないとどのような問題が起き得るでしょうか？
AuthorテーブルのidカラムがBookテーブルに紐づいている場合
```
外部キー制約を定義しなかった場合、参照整合性がないため以下のエラーを検知することができない
- 存在しない値をauthor_idに挿入する
- 関連付いた行を消そうとする

```
逆に外部キー制約を定義することでどのような問題が起き得るでしょうか？
```
関連するデータを作成・更新・削除しようとした際に関連するレコードの管理が面倒になる

#### 外部キー制約を使用する・しないタイミング
概要: 強い整合性には外部キーを使用し、弱い整合性(結果整合性)では外部キーは必ずしも使う必要はない


強い整合性 - 作成・更新・削除を行うときに関連テーブルも同時に行う必要がある整合性
弱い整合性 - 関連するテーブル同士のライフサイクルが違うため外部キーを適用できない

参考記事: [外部キー制約は何も考えずに適用するとよくない](https://blog.j5ik2o.me/entry/2020/06/16/105311)

参考記事: [外部キー制約が一切ないと何に困るのか？](https://zenn.dev/praha/articles/2667cbb1ab7233?redirected=1)

参考記事①の例を自分の言葉で要約します。
```
売上テーブルと売上詳細テーブルは、作成・更新・削除を概念的に個別で行わせることはない。
片方に変更があれば、もう片方も同じく変更が入る。この二つを分けて考えることはできない。
-> 強い整合性

一方で商品テーブルは、売上が作成された時点では商品は存在するが、
将来的に商品はなくなってしまう可能性があり、売上とライフサイクルが同じでない。
-> 弱い整合性
```
外部制約を適用すると、商品が廃盤になった際に物理削除ができない。もちろん論理削除で対応もできる。

結論: ライフサイクルが違う二つのテーブルは弱い整合性があり外部キーを必要としない

### 課題2



### 課題3

